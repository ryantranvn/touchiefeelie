$(document).ready(function(){function t(t){var e='<div class="alert alert-danger alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span class="col-white" aria-hidden="true">×</span></button><ul>';return e+="<li>"+t+"</li>",e+="</ul></div>"}function e(t){var e='<div class="alert alert-success alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span class="col-white" aria-hidden="true">×</span></button><ul>';return e+="<li>"+t+"</li>",e+="</ul></div>"}function a(){$(".alert").length>0&&setTimeout(function(){$(".alert").fadeOut(1e3)},3e3)}function n(t){return $listDatetime=t.split(" "),$listDatetime}function r(t){var e={order:[{value:"0",text:trans.order_pending,color:"bg-blue"},{value:"1",text:trans.on_delivery,color:"bg-green"},{value:"2",text:trans.done,color:"bg-grey"},{value:"3",text:trans.cancel,color:"bg-black"}]};return e[t]}function i(t){return t.prop("tagName").toLowerCase()}function s(){$("body").find(".positiveNumber").inputmask({alias:"numeric",groupSeparator:"",autoGroup:!0,digits:0,digitsOptional:!1,prefix:"",allowMinus:!1,rightAlign:!1,removeMaskOnSubmit:!0})}function l(){$("body").find(".currencyPositive").inputmask({alias:"numeric",groupSeparator:",",autoGroup:!0,digits:0,digitsOptional:!1,prefix:"",allowMinus:!1,removeMaskOnSubmit:!0})}function o(){$("body").find(".telNumber").inputmask({regex:"[0-9]*"})}function d(t){var e=t.prop("checked"),a=t.closest(".switch").find(".switchOn"),n=t.closest(".switch").find(".switchOff");1==e?(t.val(1),a.addClass("switchOnActive"),n.removeClass("switchOffActive")):(t.val(0),n.addClass("switchOffActive"),a.removeClass("switchOnActive"))}function c(t){var e={};return location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,a,n){e[a]=n}),t?e[t]:e}function u(t,e,a){var n=$("#"+t),r;n.on("show.bs.modal",function(t){n.find("#"+e).each(function(){r=$(this),n.find(".frmModal").each(function(){$(this).addClass("hide")}),"frmStatus"!=e&&(n.find('input[type="password"]').val(""),n.find('input[type="text"]').val(""),n.find("label.error").remove()),r.removeClass("hide")}),n.find('input[name="id"]').length>0&&n.find('input[name="id"]').val(a),n.find(".btnModalSubmit").length>0&&n.find(".btnModalSubmit").click(function(){r.submit()}),$("body").on("click","#frmStatus a.btn",function(t){t.preventDefault(),$(".page-loader-wrapper").fadeIn();var e=$(this).closest("#frmStatus"),a=$(this).attr("data-status");e.find('input[name="status"]').val(a),e.submit()})}),n.modal({backdrop:"static",keyboard:!1})}function p(n){var r=n.attr("data-old"),i=n.val(),s=n.parent("td.editInline"),l=s.attr("data-field"),o=s.attr("data-field-id"),d=s.attr("data-id"),c=s.attr("data-table");""==i&&(i=r),$.ajax({url:ajaxUrl+"/edit-inline",dataType:"json",method:"post",data:{table:c,fieldId:o,id:d,field:l,val:i},success:function(n){0==n.error?(s.html("").html(k).find("span").html(i),s.closest(".card").find(".body").find(".block-header").after(e(n.msg))):(s.html("").html(k).find("span").html(r),s.closest(".card").find(".body").find(".block-header").after(t(n.msg))),a()},error:function(){swal({title:trans.swal_error_title,text:trans.swal_error_content,type:"error"},function(){n.focus().select()}),a()}})}function h(t){t.find('input[type="text"]').each(function(){(""==$(this).val().trim()||""==$(this).val().trim())&&$(this).prop("disabled",!0)})}function f(){return Math.random().toString(36).substr(2,6).toUpperCase()}function m(t,e,a){window.KCFinder={callBack:function(e){var n=e.substr(e.indexOf("/upload/"));t.val(n),window.KCFinder=null,"function"==typeof a&&a()}},window.open("/kcfinder/browse.php?type="+e+"&dir="+e+"/public","kcfinder_textbox","status=0, toolbar=0, location=0, menubar=0, directories=0, resizable=1, scrollbars=0, width=800, height=600, top=30, left=30")}function b(t,e,a){window.KCFinder={callBackMultiple:function(e){window.KCFinder=null;for(var n=0;n<e.length;n++){var r=e[n].substr(e[n].indexOf("/upload/"));t.value+=r+"\n"}"function"==typeof a&&a()}},"image"==e?window.open("/kcfinder/browse.php?type=images&dir=images/public","kcfinder_multiple","status=0, toolbar=0, location=0, menubar=1, directories=0, resizable=1, scrollbars=0, width=800, height=600"):"doc"==e&&window.open("/kcfinder/browse.php?type=docs&dir=docs/public","kcfinder_multiple","status=0, toolbar=0, location=0, menubar=0, directories=0, resizable=1, scrollbars=0, width=800, height=600")}function g(t,e,a,n){$.ajax({url:"/ajax/get-order-detail",dataType:"json",method:"post",data:{orderId:e},success:function(r){if(0==r.error){var i="";i+='<div class="col-sm-12 p-l-20 p-t-5">',i+='<p class="font-bold">'+trans.order_detail+"</p>",i+='<table class="table tblExtend">',i+="<thead>",i+="<tr>",i+='<td class="align-center">#</td>',i+='<td class="align-center">'+trans.product_name+"</td>",i+='<td class="align-center">'+trans.product_price+"</td>",i+='<td class="align-center">'+trans.product_quantity+"</td>",i+='<td class="align-center">'+trans.product_total+"</td>",i+="</tr>",i+="</thead>",$.each(r.orderDetails,function(t,e){i+="<tr>",i+='<td class="align-center">'+(t+1)+"</td>",i+="<td>"+e.product_name+"</td>",i+='<td class="align-right"><span class="currencyPositive">'+e.price+"</span></td>",i+='<td class="align-right">'+e.quantity+"</td>",i+='<td class="align-right"><span class="currencyPositive">'+e.total+"</span></td>",i+="</tr>"}),i+="</table>",i+="</div>",i+='<div class="col-sm-12 p-l-20 p-t-5">',i+='<p class="font-bold">'+trans.note+"</p>",i+='<textarea class="form-control orderNote" rows="5">'+a+"</textarea>",i+='<button class="btn btn-primary m-t-10 align-right btnSaveOrderNote" data-id="'+e+'">'+trans.btn_save_order_note+"</button>",i+='<span class="successReply col-red p-l-20"></span>',i+="</div>";var s='<tr class="row-extend"><td class="bg-yellow"></td><td style="padding: 10px !important" colspan="'+(n-1)+'">'+i+"</td></tr>";t.after(s),t.addClass("shown"),l()}else swal({type:"error",title:r.msg})},error:function(){swal({type:"error",title:trans.swal_error_title})}})}function v(t,e,a){$.ajax({url:"/ajax/get-scheduled-order",dataType:"json",method:"post",data:{scheduleOrderId:e},success:function(e){if(0==e.error){var i=e.order,s=n(i.created_at),o=r("order"),d='<p class="font-bold">'+trans.order+"</p>";d+='<div class="col-sm-12">',d+='<table class="table">',d+="<thead>",d+="<tr>",d+='<td class="text-center">'+trans.order_code+"</td>",d+='<td class="text-center">'+trans.day_purchase+"</td>",d+='<td class="text-center">'+trans.total+"</td>",d+="</tr>",d+="</thead>",d+="<tbody>",d+="<tr>",d+='<td class="text-center">'+i.order_code+"</td>",d+='<td class="text-center">'+s[0]+"</td>",d+='<td class="text-center"><span class="currencyPositive">'+i.total+"</span></td>",d+="</tr>",d+="</tbody>",d+="</table>",d+="</div>",d+='<p class="font-bold">'+trans.order_detail+"</p>",d+='<table class="table">',d+="<thead>",d+="<tr>",d+='<td class="text-center">#</td>',d+='<td class="text-center">'+trans.product_name+"</td>",d+='<td class="text-center">'+trans.product_price+"</td>",d+='<td class="text-center">'+trans.product_quantity+"</td>",d+='<td class="text-center">'+trans.product_total+"</td>",d+="</tr>",d+="</thead>",$.each(e.orderDetails,function(t,e){d+="<tr>",d+='<td class="text-center">'+(t+1)+"</td>",d+="<td>"+e.product_name+"</td>",d+='<td class="text-right"><span class="currencyPositive">'+e.price+"</span></td>",d+='<td class="text-right">'+e.quantity+"</td>",d+='<td class="text-right"><span class="currencyPositive">'+e.total+"</span></td>",d+="</tr>"}),d+="</table>";var c='<tr class="row-extend"><td style="background: #EA9605"></td><td style="padding: 10px !important" colspan="'+(a-1)+'">'+d+"</td></tr>";t.after(c),t.addClass("shown"),l()}},error:function(){u(trans.swal_error_title)}})}var y=c(),w="";$(".language-switch").length>0&&$(".language-switch").find("a.lang").click(function(t){t.preventDefault(),$('input[name="locale"]').val($(this).attr("data-lang")),$("#frmLanguageSwitch").submit()}),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(document).ajaxStart(function(){$(".page-loader-wrapper").fadeIn()}),$(document).ajaxStop(function(){$(".page-loader-wrapper").fadeOut()}),$.validator.setDefaults({highlight:function(t){$(t).parents(".form-line").addClass("error")},unhighlight:function(t){$(t).parents(".form-line").removeClass("error")},errorPlacement:function(t,e){$(e).parents(".form-group").append(t)}}),$.validator.addMethod("filesize",function(t,e,a){return this.optional(e)||e.files[0].size<=a},function(t){return trans.over_max_size+filesize(t,{exponent:2,round:1})});var x=$("#leftsidebar");if($("body").on("click",".navHide",function(){x.removeClass("bounceInLeft").addClass("bounceOutLeft"),$("section.content").animate({marginLeft:"20px"},"liner"),$(".navShow").removeClass("hide")}),$("body").on("click",".navShow",function(){$("section.content").animate({marginLeft:"265px"},"liner"),x.removeClass("bounceOutLeft").addClass("bounceInLeft")}),$("body").on("click",".btnDelete",function(t){t.preventDefault();var e=$(this).attr("data-action");swal({title:trans.swal_delete_title,text:trans.swal_delete_text,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:trans.swal_delete_btn_confirm,closeOnConfirm:!1},function(){$("#frmDelete").attr("action",e).submit()})}),$("body").find(".positiveNumber").length>0&&s(),$("body").find(".currencyPositive").length>0&&l(),$("body").find(".phoneNumber").length>0&&o(),$(".switch input[type=checkbox]").length>0&&($("body").find(".switch input[type=checkbox]").each(function(){var t=$(this);d(t)}),$("body").on("change",".switch input[type=checkbox]",function(){var t=$(this);d(t)})),$("table.tableResize").length>0&&$("table.tableResize").colResizable({hoverCursor:"ew-resize",dragCursor:"ew-resize"}),!$.isEmptyObject(y)&&void 0!=y.sorting){w=y.sorting;var _=$("body").find(".table th.sorting[data-sort="+w+"]");"asc"==y.by?_.addClass("sorting_asc"):_.addClass("sorting_desc")}if($("body").on("click",".table th.sorting",function(){var t=$(this),e=t.attr("data-sort"),a=window.location.href;if(y=c(),$.isEmptyObject(y))w+="?sorting="+e+"&by=asc",window.location.href=a+w;else if(void 0==y.sorting||""===y.sorting)w+="&sorting="+e+"&by=asc",window.location.href=a+w;else{var n="",r=location.href,i=y.sorting;n=i!=e?r.replace("sorting="+i,"sorting="+e):"asc"==y.by?r.replace("by=asc","by=desc"):r.replace("by=desc","by=asc"),window.location.href=n}}),$(".limit").length>0&&($(".limit255").maxlength({max:255,feedbackText:"{c}/{m}"}),$(".limit1024").maxlength({max:1023,feedbackText:"{c}/{m}"})),$(".spinner").length>0&&$(".spinner").spinner(),$("body").on("click",".btnStatus",function(){var t=$(this).attr("data-id");u("modal","frmStatus",t)}),$("body").find(".editInline").length>0){var k='<span></span><i class="material-icons iconEditInline">mode_edit</i>';$("body").find(".editInline").each(function(){var t=$(this),e=t.html();t.html("").html(k).find("span").html(e)}),$("body").on("click",".editInline",function(){var t=$(this),e=t.find("span").html();0==t.find("input").length&&(t.html("").html('<input type="text" class="inputEditInline positiveNumber" maxlength="3" data-old="'+e+'" value="'+e+'" />'),s(),$(".inputEditInline").focus().select())}),$("body").on("blur",".editInline input.inputEditInline",function(){var t=$(this);p(t)}),$("body").on("keydown",".editInline input.inputEditInline",function(t){var e=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(13==e){t.preventDefault();var a=$(this);p(a)}})}if($("body").on("click",".btnChangePassword",function(){var t=$(this).attr("data-id");u("modal","frmChangePassword",t)}),$(".searchStatus").length>0&&($("#search_all").click(function(){var t=$(this).prop("checked");if(t)$(".searchStatus").find('input[type="checkbox"]').prop("checked",!0),$(".searchStatus").find("input.searchVal").val("");else{$(".searchStatus").find('input[type="checkbox"]').prop("checked",!1);var e=$(".searchStatus").find('input[type="checkbox"]:nth-of-type(2)');e.prop("checked",!0),$(".searchStatus").find("input.searchVal").val(e.val())}}),$(".searchStatus").find('input[type="checkbox"]:not(#search_all)').click(function(){$(".searchStatus").find('input[type="checkbox"]').prop("checked",!1),$(this).prop("checked",!0),$(".searchStatus").find("input.searchVal").val($(this).val())})),$("body").on("click",".btnResetSearch",function(){$(this).closest("form.searchForm")[0].reset(),$(this).closest("form.searchForm").find('input[type="text"]').each(function(){$(this).val("")}),$(this).closest("form.searchForm").find('input[type="radio"]').each(function(){$(this).prop("checked",!1)}),$(this).closest("form.searchForm").find(".searchStatus").find('input[type="checkbox"]').prop("checked",!0),$(".selectpicker").val(""),$(".selectpicker").selectpicker("refresh")}),$("select.province_id").length>0&&$("select.district_id").length>0&&$("select.province_id").on("changed.bs.select",function(t){var e=t.target,a=e.value,n=e.getAttribute("address-group"),r=$('select[name="district_id"][address-group="'+n+'"]');$.ajax({url:"/ajax/get-districts",dataType:"json",method:"post",data:{provinceId:a},success:function(t){if(0===t.error){var e="";$.each(t.districts,function(t,a){e+='<option value="'+a.district_id+'">'+a.type+" "+a.name+"</option>"}),r.html(e),r.selectpicker("refresh")}},error:function(){swal({title:trans.swal_error_title,text:trans.swal_error_content,type:"error"})}})}),$(".thumbnailContainer").length>0){var C=!1;$(".thumbnailMultiple").length>0&&(C=!0);var S='<div class="thumbnailWrap">';S+='<a href="#" class="thumbnailFrame">',S+='<img src="'+themeUrl+'/images/default.jpg" class="img-responsive thumbnail" />',S+=1==C?'<input type="text" name="picture[]" class="inputPicture hiddenInput" readonly />':'<input type="text" name="picture" class="inputPicture hiddenInput" readonly />',S+="</a>",S+='<i class="material-icons col-red delThumbnail hide">clear</i>',S+="</div>",$("body").on("click","a.thumbnailFrame",function(t){t.preventDefault();var e=$(this).children(".inputPicture");m(e,"images",function(){var t=e.val(),a=e.parent("a.thumbnailFrame");a.children("img.thumbnail").attr("src","/storage"+t),a.next(".delThumbnail").removeClass("hide");var n=$(".thumbnailContainer").find(".delThumbnail:visible").length;1==C&&4>=n&&$(".thumbnailContainer").append(S)})}),$("body").on("click",".delThumbnail",function(t){var e=$(this).parent(".thumbnailWrap");e.remove();var a=$(".thumbnailContainer").find(".delThumbnail:visible").length,n=$(".thumbnailContainer").find(".thumbnailFrame:visible").length;0==C&&$(".thumbnailContainer").append(S)})}$(".tinyEditor").length>0&&tinymce.init({selector:"textarea.tinyEditor",menubar:!1}),$('select[name="supplier_id"]').length>0&&$('select[name="supplier_id"]').on("changed.bs.select",function(t){var e=t.target,a=e.value,n=e[t.target.selectedIndex].getAttribute("data-location-id");-1==$(this).attr("class").indexOf("forSearch")&&$('input[name="province_name"]').length>0?$.ajax({url:"/ajax/get-supplier",dataType:"json",method:"post",data:{supplierId:a},success:function(t){if(0==t.error){var e=t.supplier;$('input[name="province_name"]').val(e.province_name)}},error:function(){swal("Error")}}):$('select[name="province_id"]').length>0&&($('select[name="province_id"]').val(n),$('select[name="province_id"]').selectpicker("refresh"))}),$(".hasDetailRow").length>0&&$(".hasDetailRow").find("td.details-control").each(function(){var t=$(this),e=$(this).parent(),a=e.children("td").length;t.click(function(){if(e.hasClass("shown"))e.next("tr").remove(),e.removeClass("shown");else if($(".tableOrder").length>0){var n=t.attr("data-id"),r=t.attr("data-note");g(e,n,r,a)}else if($(".tableScheduleOrder".length>0)){var i=t.attr("data-schedule-order-id");v(e,i,a)}})}),$("#frmSupplier").length>0&&$("#frmSupplier").validate({rules:{name:{required:!0,maxlength:255},province_id:{required:!0}},submitHandler:function(t){t.submit()}}),$("#frmUploadPicture").length>0&&($("body").on("click","a.btnPicture",function(t){t.preventDefault(),$("#frmUploadPicture").find('input[type="file"]').click()}),$("body").on("change",'input[type="file"]',function(){$("#frmUploadPicture").submit()}),$("#frmUploadPicture").validate({rules:{file:{required:!0,accept:"image/*",filesize:maxsize}},errorPlacement:function(t,e){$(".errorPicture").html(t).removeClass("hide")},submitHandler:function(t){t.submit()}})),$("body").on("click",".btnGeneratePassword",function(){var t=f();$('input[name="password_auto"]').val(t),$('input[name="password"]').val(t),$('input[name="password_confirmation"]').val(t),$(".btnClearAutoPassword").removeClass("hide")}),$("body").on("click",".btnClearAutoPassword",function(){$('input[name="password_auto"]').val(""),$('input[name="password"]').val(""),$('input[name="password_confirmation"]').val(""),$(this).addClass("hide")}),$("#frmUser").length>0&&$("#frmUser").validate({rules:{name:{required:!0,maxlength:255},email:{required:!0,email:!0},phone:{required:!0,maxlength:12},password:{required:!0,minlength:6,maxlength:255},password_confirmation:{equalTo:"#password"}},submitHandler:function(t){t.submit()}}),$("#frmUser").length>0&&$("#frmUser").validate({rules:{name:{required:!0,maxlength:255},email:{required:!0,email:!0},phone:{required:!0,maxlength:12},password:{required:!0,minlength:6,maxlength:255},password_confirmation:{equalTo:"#password"}},submitHandler:function(t){t.submit()}}),$("#frmChangePassword").length>0&&$("#frmChangePassword").validate({rules:{password:{required:!0,minlength:6,maxlength:255},password_confirmation:{equalTo:"#password"}},submitHandler:function(t){t.submit()}}),$("#frmSearchCategory").length>0&&$("#frmSearchCategory").validate({rules:{category_name:{require_from_group:[1,".searchCategory"],maxlength:255},category_status:{require_from_group:[1,".searchCategory"]}},submitHandler:function(t){h($("#frmSearchCategory")),t.submit()}}),$("#frmCategory").length>0&&$("#frmCategory").validate({rules:{category_name:{required:!0,maxlength:255},category_desc:{maxlength:1023},category_order:{required:!0,max:999}}}),$("#frmProduct").length>0&&$("#frmProduct").validate({rules:{supplier_id:{required:!0},category_id:{required:!0},name:{required:!0,maxlength:255}}}),$("#frmUpload").length>0&&($(".btnUpload").click(function(t){t.preventDefault(),$("#frmUpload").find('input[name="file"]').click()}),$("#frmUpload").find('input[name="file"]').change(function(){$("#frmUpload").submit()})),$("body").on("click",".btnSaveOrderNote",function(){var t=$(this),e=t.attr("data-id"),a=t.prev("textarea.orderNote").val().trim();""==a?swal({type:"error",title:trans.require_input_content}):$.ajax({url:ajaxUrl+"/update_order_note",dataType:"json",method:"post",data:{orderId:e,note:a},success:function(e){0==e.error?t.next(".successReply").html(e.msg).fadeIn("fast").delay(3e3).fadeOut("slow"):swal({type:"error",title:e.msg})},error:function(){swal({type:"error",title:trans.swal_error_title})}})}),$(".tableSetting").length>0&&($(".btnEdit").click(function(){var t=$(this),e=t.parent("td").parent("tr").find(".wrapEdit"),a=e.find(".wrapValue"),n=e.find(".wrapField");a.addClass("hide"),n.removeClass("hide"),t.prop("disabled",!0)}),$(".btnSave").click(function(){var t=$(this),e=t.parent(".wrapField"),a=e.parent(".wrapEdit"),n=a.find(".wrapValue"),r=a.parent("tr").find(".btnEdit"),i=a.find('input[name="settingId"]').val(),s=a.find(".settingValue").val();$.ajax({url:ajaxUrl+"/edit-setting",dataType:"json",method:"post",data:{settingId:i,settingValue:s},success:function(t){0==t.error?(e.addClass("hide"),n.html(s).removeClass("hide"),r.prop("disabled",!1)):swal(t.msg)},error:function(){swal("Error")}})}))});